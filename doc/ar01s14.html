<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Using ModAssert with DLLs</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.70.1"><link rel="start" href="index.html" title="Modular Assertions version 2.0.6"><link rel="up" href="index.html" title="Modular Assertions version 2.0.6"><link rel="prev" href="ar01s13.html" title="Enabling and disabling the reporting of Modular Assertions at compile time"><link rel="next" href="ar01s15.html" title="Disabling condition text"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Using ModAssert with DLLs</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s13.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s15.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id530294"></a>Using ModAssert with DLLs</h2></div></div></div><a class="indexterm" name="id530299"></a><a class="indexterm" name="id530303"></a><a class="indexterm" name="id530308"></a><p>When an application uses one or more DLLs, of which more than one use ModAssert, it may be preferable
that all assertions and checks are processed by the same instance of ModAssert.
This can be achieved with the functions <code class="code">GetState</code> and <code class="code">SetState</code>,
which are declared in the include file <code class="filename">modassert/handler.hpp</code>.
<code class="code">GetState</code> returns a pointer to an object of the class <code class="classname">State</code>,
that wraps the responder, all the loggers, hooks and other information that was set in the setup of ModAssert,
as well as info about which assertions and checks should be ignored (except if determined at compile time).
<code class="code">SetState</code> forces an instance of ModAssert to use that state instead of its own state.</p><p>It is recommended to do the setup of ModAssert in the executable or one of the DLLs, get the
<code class="classname">State</code> pointer with <code class="code">GetState</code> in that instance (before or after setup)
and call <code class="code">SetState</code> with that pointer in the other DLLs and/or executable.
This will require an exported function in every DLL that uses ModAssert to either set or get the state.</p><p>At the moment this does not work with Visual C++ 6 (this will probably not be fixed, unless there is
a clear need for it).</p><p>Note that ModAssert and Rich Booleans still have to be linked in every executable and DLL that uses
ModAssert.</p><p>There are examples of how to do this in the <code class="filename">demos</code> folder:
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The folder <code class="filename">demos\LibInDLL</code> contains the projects <code class="filename">DemoLibInDLL-&lt;compiler&gt;</code>,
		that builds a DLL where ModAssert is setup, and <code class="filename">DemoLibInDLL_AssertionInExe-&lt;compiler&gt;</code>
		that builds an executable with a failing assertion that is reported by ModAssert in the DLL.</li><li style="list-style-type: disc">The folder <code class="filename">demos\LibInExe</code> contains the projects <code class="filename">DemoLibInExe-&lt;compiler&gt;</code>,
		that builds an executable where ModAssert is setup, and <code class="filename">DemoLibInExe_AssertionInDLL-&lt;compiler&gt;</code>
		that builds a DLL with a failing assertion that is reported by ModAssert in the executable.</li></ul></div><p>
</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s13.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s15.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Enabling and disabling the reporting of Modular Assertions at compile time </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Disabling condition text</td></tr></table></div></body></html>
